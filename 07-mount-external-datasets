#!/bin/sh -x

. /usr/local/etc/host-init/jail-vars.sh

# this is where we mount the repo
# why externally mounted and not internal?
# I don't know. No real reason.

# set the mountpoint in the jail
zfs set mountpoint=${jailroot}/ingress01/var/db/freshports/ports-jail/var/db/repos ${jailzpool}/freshports/ingress01/freshports/repos
zfs set mountpoint=${jailroot}/ingress01/var/db/ingress/repos                      ${jailzpool}/freshports/ingress01/ingress/repos

zfs mount ${jailzpool}/freshports/ingress01/freshports/repos
zfs mount ${jailzpool}/freshports/ingress01/ingress/repos

if [ ! -d ${jailroot}/ingress01/var/db/freshports/ports-jail/var/db/repos ]
then
  echo ${jailroot}/ingress01/var/db/freshports/ports-jail/var/db/repos does not exist
  exit 12
fi

# check out head if it does not already exist
if [ ! -d "${jailroot}/ingress01/var/db/freshports/ports-jail/var/db/repos/PORTS-head" ]
then
  echo directory does not exist
  cd ${jailroot}/ingress01/var/db/freshports/ports-jail/var/db/repos
  svn co svn://svn.freebsd.org/ports/head PORTS-head
else
  echo PORTS-head already exists
fi

